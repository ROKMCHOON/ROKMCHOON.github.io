```python
pd.__version__
```




    '1.2.4'




```python
s = pd.Series([0, 0.25, 0.5, 0.75, 1.0])
s
```




    0    0.00
    1    0.25
    2    0.50
    3    0.75
    4    1.00
    dtype: float64




```python
s.values
```




    array([0.  , 0.25, 0.5 , 0.75, 1.  ])




```python
s.index
```




    RangeIndex(start=0, stop=5, step=1)




```python
s[1]
```




    0.25




```python
s[1:4]
```




    1    0.25
    2    0.50
    3    0.75
    dtype: float64




```python
s = pd.Series([0,0.25,0.5,0.75,1.0],
    index = ['a','b','c','d','e'])
s
```




    a    0.00
    b    0.25
    c    0.50
    d    0.75
    e    1.00
    dtype: float64




```python
s[['c','d','e']]
```




    c    0.50
    d    0.75
    e    1.00
    dtype: float64




```python
'b' in s
```




    True




```python
s.unique()
```




    array([0.  , 0.25, 0.5 , 0.75, 1.  ])




```python
s.value_counts()
```




    0.00    1
    1.00    1
    0.50    1
    0.75    1
    0.25    1
    dtype: int64




```python
s.isin([0.25,0.75])
```




    a    False
    b     True
    c    False
    d     True
    e    False
    dtype: bool




```python
pop_tuple = {'서울특별시' : 9720846,
             '부산광역시' : 3404423,
             '인천광역시' : 2947217,
             '대구광역시' : 2427954,
             '대전광역시' : 1471040,
             '광주광역시' : 1455058}
population = pd.Series(pop_tuple)
population
```




    서울특별시    9720846
    부산광역시    3404423
    인천광역시    2947217
    대구광역시    2427954
    대전광역시    1471040
    광주광역시    1455058
    dtype: int64




```python
population['서울특별시']
```




    9720846




```python
population['서울특별시' : '인천광역시']
```




    서울특별시    9720846
    부산광역시    3404423
    인천광역시    2947217
    dtype: int64




```python
pd.DataFrame([{'A':2, 'B':4, 'D':3}, {'A':4, 'B':5, 'C':7}])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>D</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>4</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>NaN</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.DataFrame(np.random.rand(5,5),
            columns = ['A','B','C','D','E'],
            index=[1,2,3,4,5])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.231112</td>
      <td>0.164728</td>
      <td>0.048313</td>
      <td>0.984469</td>
      <td>0.259352</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093701</td>
      <td>0.457589</td>
      <td>0.209987</td>
      <td>0.103723</td>
      <td>0.709007</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.352152</td>
      <td>0.673779</td>
      <td>0.677508</td>
      <td>0.735916</td>
      <td>0.362353</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.776853</td>
      <td>0.250416</td>
      <td>0.913275</td>
      <td>0.360487</td>
      <td>0.519379</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.074056</td>
      <td>0.097425</td>
      <td>0.852671</td>
      <td>0.244903</td>
      <td>0.311931</td>
    </tr>
  </tbody>
</table>
</div>




```python
male_tuple = {'서울특별시' : 4732275,
             '부산광역시' : 1668618,
             '인천광역시' : 1476813,
             '대구광역시' : 1198815,
             '대전광역시' : 734441,
             '광주광역시' : 720060}
male = pd.Series(male_tuple)
male
```




    서울특별시    4732275
    부산광역시    1668618
    인천광역시    1476813
    대구광역시    1198815
    대전광역시     734441
    광주광역시     720060
    dtype: int64




```python
female_tuple = {'서울특별시' : 4988571,
             '부산광역시' : 1735805,
             '인천광역시' : 1470404,
             '대구광역시' : 1229139,
             '대전광역시' : 736599,
             '광주광역시' : 734988}
female = pd.Series(female_tuple)
female
```




    서울특별시    4988571
    부산광역시    1735805
    인천광역시    1470404
    대구광역시    1229139
    대전광역시     736599
    광주광역시     734988
    dtype: int64




```python
korea_df = pd.DataFrame({ '인구수' : population,
                          '남자인구수' : male,
                          '여자인구수' : female})
korea_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
    </tr>
    <tr>
      <th>대전광역시</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
    </tr>
    <tr>
      <th>광주광역시</th>
      <td>1455058</td>
      <td>720060</td>
      <td>734988</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.index
```




    Index(['서울특별시', '부산광역시', '인천광역시', '대구광역시', '대전광역시', '광주광역시'], dtype='object')




```python
korea_df.columns
```




    Index(['인구수', '남자인구수', '여자인구수'], dtype='object')




```python
korea_df['여자인구수']
```




    서울특별시    4988571
    부산광역시    1735805
    인천광역시    1470404
    대구광역시    1229139
    대전광역시     736599
    광주광역시     734988
    Name: 여자인구수, dtype: int64




```python
korea_df['서울특별시':'인천광역시']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
    </tr>
  </tbody>
</table>
</div>



### 인덱스 객체


```python
idx = pd.Index([2,4,6,8,10])
idx
```




    Int64Index([2, 4, 6, 8, 10], dtype='int64')




```python
idx[1]
```




    4




```python
idx[1:2:2]
```




    Int64Index([4], dtype='int64')




```python
idx[::2]
```




    Int64Index([2, 6, 10], dtype='int64')




```python
print(idx)
print(idx.size)
print(idx.shape)
print(idx.ndim)
print(idx.dtype)
```

    Int64Index([2, 4, 6, 8, 10], dtype='int64')
    5
    (5,)
    1
    int64
    

### index 연산


```python
idx1 = pd.Index([1,2,4,6,8])
idx2 = pd.Index([2,4,5,6,7])
print(idx1.append(idx2))
print(idx1.difference(idx2))
print(idx1 - idx2)
print(idx1.intersection(idx2))
print(idx1 & idx2)
print(idx1.union(idx2))
print(idx1 | idx2)
print(idx1.delete(0))
print(idx1.drop(1))
print(idx1 ^ idx2)
```

    Int64Index([1, 2, 4, 6, 8, 2, 4, 5, 6, 7], dtype='int64')
    Int64Index([1, 8], dtype='int64')
    Int64Index([-1, -2, -1, 0, 1], dtype='int64')
    Int64Index([2, 4, 6], dtype='int64')
    Int64Index([2, 4, 6], dtype='int64')
    Int64Index([1, 2, 4, 5, 6, 7, 8], dtype='int64')
    Int64Index([1, 2, 4, 5, 6, 7, 8], dtype='int64')
    Int64Index([2, 4, 6, 8], dtype='int64')
    Int64Index([2, 4, 6, 8], dtype='int64')
    Int64Index([1, 5, 7, 8], dtype='int64')
    

    <ipython-input-50-47eb462ab82c>:7: FutureWarning: Index.__and__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__and__.  Use index.intersection(other) instead
      print(idx1 & idx2)
    <ipython-input-50-47eb462ab82c>:9: FutureWarning: Index.__or__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__or__.  Use index.union(other) instead
      print(idx1 | idx2)
    <ipython-input-50-47eb462ab82c>:12: FutureWarning: Index.__xor__ operating as a set operation is deprecated, in the future this will be a logical operation matching Series.__xor__.  Use index.symmetric_difference(other) instead
      print(idx1 ^ idx2)
    

### 인덱싱


```python
s = pd.Series([0,0.25,0.5,0.75,1.0],
             index = ['a','b','c','d','e'])
s
```




    a    0.00
    b    0.25
    c    0.50
    d    0.75
    e    1.00
    dtype: float64




```python
s['b']
```




    0.25




```python
'b' in s
```




    True




```python
s.keys()
```




    Index(['a', 'b', 'c', 'd', 'e'], dtype='object')




```python
list(s.items())
```




    [('a', 0.0), ('b', 0.25), ('c', 0.5), ('d', 0.75), ('e', 1.0)]




```python
s['f'] = 1.25
s
```




    a    0.00
    b    0.25
    c    0.50
    d    0.75
    e    1.00
    f    1.25
    dtype: float64




```python
s['a':'d']
```




    a    0.00
    b    0.25
    c    0.50
    d    0.75
    dtype: float64




```python
s[0:4]
```




    a    0.00
    b    0.25
    c    0.50
    d    0.75
    dtype: float64




```python
s[(s > 0.4) & (s < 0.8)]
```




    c    0.50
    d    0.75
    dtype: float64




```python
s[['a','c','e']]
```




    a    0.0
    c    0.5
    e    1.0
    dtype: float64



### Series 인덱싱


```python
s = pd.Series(['a','b','c','d','e'],
             index = [1,3,5,7,9])
s
```




    1    a
    3    b
    5    c
    7    d
    9    e
    dtype: object




```python
s[1]
```




    'a'




```python
s[2:4]
```




    5    c
    7    d
    dtype: object




```python
s.iloc[1]
```




    'b'




```python
s.iloc[2:4]
```




    5    c
    7    d
    dtype: object




```python
s.reindex(range(10))
```




    0    NaN
    1      a
    2    NaN
    3      b
    4    NaN
    5      c
    6    NaN
    7      d
    8    NaN
    9      e
    dtype: object




```python
s.reindex(range(10), method='bfill')
```




    0    a
    1    a
    2    b
    3    b
    4    c
    5    c
    6    d
    7    d
    8    e
    9    e
    dtype: object



### DataFrame 인덱싱


```python
korea_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
    </tr>
    <tr>
      <th>대전광역시</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
    </tr>
    <tr>
      <th>광주광역시</th>
      <td>1455058</td>
      <td>720060</td>
      <td>734988</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df['남자인구수']
```




    서울특별시    4732275
    부산광역시    1668618
    인천광역시    1476813
    대구광역시    1198815
    대전광역시     734441
    광주광역시     720060
    Name: 남자인구수, dtype: int64




```python
korea_df.남자인구수
```




    서울특별시    4732275
    부산광역시    1668618
    인천광역시    1476813
    대구광역시    1198815
    대전광역시     734441
    광주광역시     720060
    Name: 남자인구수, dtype: int64




```python
korea_df.여자인구수
```




    서울특별시    4988571
    부산광역시    1735805
    인천광역시    1470404
    대구광역시    1229139
    대전광역시     736599
    광주광역시     734988
    Name: 여자인구수, dtype: int64




```python
korea_df['남여비율'] = (korea_df['남자인구수'] * 100 / korea_df['여자인구수'])
```


```python
korea_df.남여비율
```




    서울특별시     94.862336
    부산광역시     96.129346
    인천광역시    100.435867
    대구광역시     97.532907
    대전광역시     99.707032
    광주광역시     97.968946
    Name: 남여비율, dtype: float64




```python
korea_df.values
```




    array([[9.72084600e+06, 4.73227500e+06, 4.98857100e+06, 9.48623363e+01],
           [3.40442300e+06, 1.66861800e+06, 1.73580500e+06, 9.61293463e+01],
           [2.94721700e+06, 1.47681300e+06, 1.47040400e+06, 1.00435867e+02],
           [2.42795400e+06, 1.19881500e+06, 1.22913900e+06, 9.75329072e+01],
           [1.47104000e+06, 7.34441000e+05, 7.36599000e+05, 9.97070319e+01],
           [1.45505800e+06, 7.20060000e+05, 7.34988000e+05, 9.79689464e+01]])




```python
korea_df.T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>서울특별시</th>
      <th>부산광역시</th>
      <th>인천광역시</th>
      <th>대구광역시</th>
      <th>대전광역시</th>
      <th>광주광역시</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>인구수</th>
      <td>9.720846e+06</td>
      <td>3.404423e+06</td>
      <td>2.947217e+06</td>
      <td>2.427954e+06</td>
      <td>1.471040e+06</td>
      <td>1.455058e+06</td>
    </tr>
    <tr>
      <th>남자인구수</th>
      <td>4.732275e+06</td>
      <td>1.668618e+06</td>
      <td>1.476813e+06</td>
      <td>1.198815e+06</td>
      <td>7.344410e+05</td>
      <td>7.200600e+05</td>
    </tr>
    <tr>
      <th>여자인구수</th>
      <td>4.988571e+06</td>
      <td>1.735805e+06</td>
      <td>1.470404e+06</td>
      <td>1.229139e+06</td>
      <td>7.365990e+05</td>
      <td>7.349880e+05</td>
    </tr>
    <tr>
      <th>남여비율</th>
      <td>9.486234e+01</td>
      <td>9.612935e+01</td>
      <td>1.004359e+02</td>
      <td>9.753291e+01</td>
      <td>9.970703e+01</td>
      <td>9.796895e+01</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.인구수
```




    서울특별시    9720846
    부산광역시    3404423
    인천광역시    2947217
    대구광역시    2427954
    대전광역시    1471040
    광주광역시    1455058
    Name: 인구수, dtype: int64




```python
korea_df.loc[:'인천광역시', :'남자인구수']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.loc[(korea_df.여자인구수 > 1000000)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남여비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.loc[(korea_df.여자인구수 < 2000000)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남여비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th>대전광역시</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th>광주광역시</th>
      <td>1455058</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.loc[(korea_df.인구수 > 2500000)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남여비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.loc[(korea_df.남여비율 > 100)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남여비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.loc[(korea_df.인구수 > 2500000) & (korea_df.남여비율 > 100)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남여비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_df.iloc[:3, :2]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
    </tr>
  </tbody>
</table>
</div>



### 다중 인덱싱
    - 1차원의 Series와 2차원의 DataFrame 객체를 넘어 3차원, 4차원 이상의 고차원 데이터 처리
    - 단일 인덱스 내에 여러 인덱스를 포함하는 다중 인덱싱


```python
korea_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남여비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>서울특별시</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th>대전광역시</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th>광주광역시</th>
      <td>1455058</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
  </tbody>
</table>
</div>




```python
index_tuples = [('서울특별시',2010), ('서울특별시' , 2020),
               ('부산광역시',2010), ('부산광역시' , 2020),
               ('인천광역시',2010), ('인천광역시' , 2020),
               ('대구광역시',2010), ('대구광역시' , 2020),
               ('대전광역시',2010), ('대전광역시' , 2020),
               ('광주광역시',2010), ('광주광역시' , 2020),]
index_tuples
```




    [('서울특별시', 2010),
     ('서울특별시', 2020),
     ('부산광역시', 2010),
     ('부산광역시', 2020),
     ('인천광역시', 2010),
     ('인천광역시', 2020),
     ('대구광역시', 2010),
     ('대구광역시', 2020),
     ('대전광역시', 2010),
     ('대전광역시', 2020),
     ('광주광역시', 2010),
     ('광주광역시', 2020)]




```python
pop_tuples = [10312545, 9720846,
             2567910, 3404423,
             2758296, 2947217,
             2511676, 2427954,
             1503664, 1471040,
             1454636, 1455048]
population = pd.Series(pop_tuples, index=index_tuples)
population
```




    (서울특별시, 2010)    10312545
    (서울특별시, 2020)     9720846
    (부산광역시, 2010)     2567910
    (부산광역시, 2020)     3404423
    (인천광역시, 2010)     2758296
    (인천광역시, 2020)     2947217
    (대구광역시, 2010)     2511676
    (대구광역시, 2020)     2427954
    (대전광역시, 2010)     1503664
    (대전광역시, 2020)     1471040
    (광주광역시, 2010)     1454636
    (광주광역시, 2020)     1455048
    dtype: int64




```python
midx = pd.MultiIndex.from_tuples(index_tuples)
midx
```




    MultiIndex([('서울특별시', 2010),
                ('서울특별시', 2020),
                ('부산광역시', 2010),
                ('부산광역시', 2020),
                ('인천광역시', 2010),
                ('인천광역시', 2020),
                ('대구광역시', 2010),
                ('대구광역시', 2020),
                ('대전광역시', 2010),
                ('대전광역시', 2020),
                ('광주광역시', 2010),
                ('광주광역시', 2020)],
               )




```python
population = population.reindex(midx)
population
```




    서울특별시  2010    10312545
           2020     9720846
    부산광역시  2010     2567910
           2020     3404423
    인천광역시  2010     2758296
           2020     2947217
    대구광역시  2010     2511676
           2020     2427954
    대전광역시  2010     1503664
           2020     1471040
    광주광역시  2010     1454636
           2020     1455048
    dtype: int64




```python
population[:,2010]
```




    서울특별시    10312545
    부산광역시     2567910
    인천광역시     2758296
    대구광역시     2511676
    대전광역시     1503664
    광주광역시     1454636
    dtype: int64




```python
population['대전광역시',:]
```




    2010    1503664
    2020    1471040
    dtype: int64




```python
korea_mdf = population.unstack()
korea_mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2010</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>광주광역시</th>
      <td>1454636</td>
      <td>1455048</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>2511676</td>
      <td>2427954</td>
    </tr>
    <tr>
      <th>대전광역시</th>
      <td>1503664</td>
      <td>1471040</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>2567910</td>
      <td>3404423</td>
    </tr>
    <tr>
      <th>서울특별시</th>
      <td>10312545</td>
      <td>9720846</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2758296</td>
      <td>2947217</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_mdf.stack()
```




    광주광역시  2010     1454636
           2020     1455048
    대구광역시  2010     2511676
           2020     2427954
    대전광역시  2010     1503664
           2020     1471040
    부산광역시  2010     2567910
           2020     3404423
    서울특별시  2010    10312545
           2020     9720846
    인천광역시  2010     2758296
           2020     2947217
    dtype: int64




```python
male_tuples = [5111259, 4732275,
             1773170, 1668618,
             1390356, 1476813,
             1255245, 1198815,
             753648, 734441,
             721780, 720060]
male_tuples
```




    [5111259,
     4732275,
     1773170,
     1668618,
     1390356,
     1476813,
     1255245,
     1198815,
     753648,
     734441,
     721780,
     720060]




```python
korea_mdf = pd.DataFrame({"총인구수" : population,
                         "남자인구수" : male_tuples})
korea_mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>총인구수</th>
      <th>남자인구수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">서울특별시</th>
      <th>2010</th>
      <td>10312545</td>
      <td>5111259</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>9720846</td>
      <td>4732275</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">부산광역시</th>
      <th>2010</th>
      <td>2567910</td>
      <td>1773170</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>3404423</td>
      <td>1668618</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">인천광역시</th>
      <th>2010</th>
      <td>2758296</td>
      <td>1390356</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2947217</td>
      <td>1476813</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대구광역시</th>
      <th>2010</th>
      <td>2511676</td>
      <td>1255245</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2427954</td>
      <td>1198815</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대전광역시</th>
      <th>2010</th>
      <td>1503664</td>
      <td>753648</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1471040</td>
      <td>734441</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">광주광역시</th>
      <th>2010</th>
      <td>1454636</td>
      <td>721780</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1455048</td>
      <td>720060</td>
    </tr>
  </tbody>
</table>
</div>




```python
female_tuples = [5201286, 4988571,
                1794740, 1735805,
                1367940, 1470404,
                1256431, 1229139,
                750016, 736599,
                732856, 734988]
```


```python
korea_mdf = pd.DataFrame({"총인구수" : population,
                         "남자인구수" : male_tuples,
                         "여자인구수" : female_tuples})
korea_mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">서울특별시</th>
      <th>2010</th>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">부산광역시</th>
      <th>2010</th>
      <td>2567910</td>
      <td>1773170</td>
      <td>1794740</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">인천광역시</th>
      <th>2010</th>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대구광역시</th>
      <th>2010</th>
      <td>2511676</td>
      <td>1255245</td>
      <td>1256431</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대전광역시</th>
      <th>2010</th>
      <td>1503664</td>
      <td>753648</td>
      <td>750016</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">광주광역시</th>
      <th>2010</th>
      <td>1454636</td>
      <td>721780</td>
      <td>732856</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1455048</td>
      <td>720060</td>
      <td>734988</td>
    </tr>
  </tbody>
</table>
</div>




```python
ratio = korea_mdf['남자인구수'] * 100 / korea_mdf['여자인구수']
ratio
```




    서울특별시  2010     98.269140
           2020     94.862336
    부산광역시  2010     98.798155
           2020     96.129346
    인천광역시  2010    101.638668
           2020    100.435867
    대구광역시  2010     99.905606
           2020     97.532907
    대전광역시  2010    100.484256
           2020     99.707032
    광주광역시  2010     98.488653
           2020     97.968946
    dtype: float64




```python
ratio.unstack()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2010</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>광주광역시</th>
      <td>98.488653</td>
      <td>97.968946</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>99.905606</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th>대전광역시</th>
      <td>100.484256</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>98.798155</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>서울특별시</th>
      <td>98.269140</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>101.638668</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_mdf = pd.DataFrame({"총인구수" : population,
                         "남자인구수" : male_tuples,
                         "여자인구수" : female_tuples,
                         "남녀비율" : ratio})
korea_mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남녀비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">서울특별시</th>
      <th>2010</th>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
      <td>98.269140</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">부산광역시</th>
      <th>2010</th>
      <td>2567910</td>
      <td>1773170</td>
      <td>1794740</td>
      <td>98.798155</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">인천광역시</th>
      <th>2010</th>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대구광역시</th>
      <th>2010</th>
      <td>2511676</td>
      <td>1255245</td>
      <td>1256431</td>
      <td>99.905606</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대전광역시</th>
      <th>2010</th>
      <td>1503664</td>
      <td>753648</td>
      <td>750016</td>
      <td>100.484256</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">광주광역시</th>
      <th>2010</th>
      <td>1454636</td>
      <td>721780</td>
      <td>732856</td>
      <td>98.488653</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1455048</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
  </tbody>
</table>
</div>



### 다중 인덱스 생성


```python
df = pd.DataFrame(np.random.rand(6,3),
                  index = [['a','a','b','b','c','c'],[1,2,1,2,1,2]],
                           columns=['c1','c2','c3'])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>c1</th>
      <th>c2</th>
      <th>c3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0.663769</td>
      <td>0.325597</td>
      <td>0.387873</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.377855</td>
      <td>0.750860</td>
      <td>0.725217</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>0.143703</td>
      <td>0.763345</td>
      <td>0.395607</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.723461</td>
      <td>0.769325</td>
      <td>0.054305</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">c</th>
      <th>1</th>
      <td>0.398800</td>
      <td>0.339523</td>
      <td>0.270084</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.010127</td>
      <td>0.754708</td>
      <td>0.290708</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.MultiIndex.from_arrays([['a','a','b','b','c','c'],[1,2,1,2,1,2]])
```




    MultiIndex([('a', 1),
                ('a', 2),
                ('b', 1),
                ('b', 2),
                ('c', 1),
                ('c', 2)],
               )




```python
pd.MultiIndex.from_arrays([('a',1),('a',2),('b',1),('b',2),('c',1),('c',2)])
```




    MultiIndex([('a', 'a', 'b', 'b', 'c', 'c'),
                (  1,   2,   1,   2,   1,   2)],
               )




```python
pd.MultiIndex.from_product([['a','b','c'],[1,2]])
```




    MultiIndex([('a', 1),
                ('a', 2),
                ('b', 1),
                ('b', 2),
                ('c', 1),
                ('c', 2)],
               )




```python
pd.MultiIndex(levels=[['a','b','c'],[1,2]],
             codes=[[0,0,1,1,2,2],[0,1,0,1,0,1]])
```




    MultiIndex([('a', 1),
                ('a', 2),
                ('b', 1),
                ('b', 2),
                ('c', 1),
                ('c', 2)],
               )




```python
population
```




    서울특별시  2010    10312545
           2020     9720846
    부산광역시  2010     2567910
           2020     3404423
    인천광역시  2010     2758296
           2020     2947217
    대구광역시  2010     2511676
           2020     2427954
    대전광역시  2010     1503664
           2020     1471040
    광주광역시  2010     1454636
           2020     1455048
    dtype: int64




```python
population.index.names = ['행정구역', '년도']
population
```




    행정구역   년도  
    서울특별시  2010    10312545
           2020     9720846
    부산광역시  2010     2567910
           2020     3404423
    인천광역시  2010     2758296
           2020     2947217
    대구광역시  2010     2511676
           2020     2427954
    대전광역시  2010     1503664
           2020     1471040
    광주광역시  2010     1454636
           2020     1455048
    dtype: int64




```python
idx = pd.MultiIndex.from_product([['a','b','c'],[1,2]],
                                names=['name1','name2'])
cols = pd.MultiIndex.from_product([['c1','c2','c3'],[1,2]],
                                 names=['col_name1','col_name2'])
data = np.round(np.random.rand(6,6),2)
mdf = pd.DataFrame(data, index=idx, columns = cols)
mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>col_name1</th>
      <th colspan="2" halign="left">c1</th>
      <th colspan="2" halign="left">c2</th>
      <th colspan="2" halign="left">c3</th>
    </tr>
    <tr>
      <th></th>
      <th>col_name2</th>
      <th>1</th>
      <th>2</th>
      <th>1</th>
      <th>2</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>name1</th>
      <th>name2</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0.67</td>
      <td>0.76</td>
      <td>0.05</td>
      <td>0.34</td>
      <td>0.57</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.45</td>
      <td>0.29</td>
      <td>0.66</td>
      <td>0.17</td>
      <td>0.23</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>0.24</td>
      <td>0.04</td>
      <td>0.62</td>
      <td>0.76</td>
      <td>0.11</td>
      <td>0.23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.68</td>
      <td>0.92</td>
      <td>0.14</td>
      <td>0.51</td>
      <td>0.87</td>
      <td>0.32</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">c</th>
      <th>1</th>
      <td>0.02</td>
      <td>0.50</td>
      <td>0.13</td>
      <td>0.97</td>
      <td>0.75</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.07</td>
      <td>0.12</td>
      <td>0.97</td>
      <td>0.38</td>
      <td>0.31</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>




```python
mdf['c2']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col_name2</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>name1</th>
      <th>name2</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0.05</td>
      <td>0.34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.66</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>0.62</td>
      <td>0.76</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.14</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">c</th>
      <th>1</th>
      <td>0.13</td>
      <td>0.97</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.97</td>
      <td>0.38</td>
    </tr>
  </tbody>
</table>
</div>



### 인덱싱 및 슬라이싱


```python
population
```




    행정구역   년도  
    서울특별시  2010    10312545
           2020     9720846
    부산광역시  2010     2567910
           2020     3404423
    인천광역시  2010     2758296
           2020     2947217
    대구광역시  2010     2511676
           2020     2427954
    대전광역시  2010     1503664
           2020     1471040
    광주광역시  2010     1454636
           2020     1455048
    dtype: int64




```python
population['인천광역시', 2010]
```




    2758296




```python
population[:, 2010]
```




    행정구역
    서울특별시    10312545
    부산광역시     2567910
    인천광역시     2758296
    대구광역시     2511676
    대전광역시     1503664
    광주광역시     1454636
    dtype: int64




```python
population[population > 3000000]
```




    행정구역   년도  
    서울특별시  2010    10312545
           2020     9720846
    부산광역시  2020     3404423
    dtype: int64




```python
population[['대구광역시','대전광역시']]
```




    행정구역   년도  
    대구광역시  2010    2511676
           2020    2427954
    대전광역시  2010    1503664
           2020    1471040
    dtype: int64




```python
mdf['c2',1]
```




    name1  name2
    a      1        0.05
           2        0.66
    b      1        0.62
           2        0.14
    c      1        0.13
           2        0.97
    Name: (c2, 1), dtype: float64




```python
mdf.iloc[:3, :4]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>col_name1</th>
      <th colspan="2" halign="left">c1</th>
      <th colspan="2" halign="left">c2</th>
    </tr>
    <tr>
      <th></th>
      <th>col_name2</th>
      <th>1</th>
      <th>2</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>name1</th>
      <th>name2</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0.67</td>
      <td>0.76</td>
      <td>0.05</td>
      <td>0.34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.45</td>
      <td>0.29</td>
      <td>0.66</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>b</th>
      <th>1</th>
      <td>0.24</td>
      <td>0.04</td>
      <td>0.62</td>
      <td>0.76</td>
    </tr>
  </tbody>
</table>
</div>




```python
mdf.loc[:, ('c2',1)]
```




    name1  name2
    a      1        0.05
           2        0.66
    b      1        0.62
           2        0.14
    c      1        0.13
           2        0.97
    Name: (c2, 1), dtype: float64




```python
idx_slice = pd.IndexSlice
mdf.loc[idx_slice[:,2], idx_slice[:,2]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>col_name1</th>
      <th>c1</th>
      <th>c2</th>
      <th>c3</th>
    </tr>
    <tr>
      <th></th>
      <th>col_name2</th>
      <th>2</th>
      <th>2</th>
      <th>2</th>
    </tr>
    <tr>
      <th>name1</th>
      <th>name2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <th>2</th>
      <td>0.29</td>
      <td>0.17</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>b</th>
      <th>2</th>
      <td>0.92</td>
      <td>0.51</td>
      <td>0.32</td>
    </tr>
    <tr>
      <th>c</th>
      <th>2</th>
      <td>0.12</td>
      <td>0.38</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>




```python
mdf['c2',1]
```




    name1  name2
    a      1        0.05
           2        0.66
    b      1        0.62
           2        0.14
    c      1        0.13
           2        0.97
    Name: (c2, 1), dtype: float64




```python
mdf.iloc[:3, :4]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>col_name1</th>
      <th colspan="2" halign="left">c1</th>
      <th colspan="2" halign="left">c2</th>
    </tr>
    <tr>
      <th></th>
      <th>col_name2</th>
      <th>1</th>
      <th>2</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>name1</th>
      <th>name2</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0.67</td>
      <td>0.76</td>
      <td>0.05</td>
      <td>0.34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.45</td>
      <td>0.29</td>
      <td>0.66</td>
      <td>0.17</td>
    </tr>
    <tr>
      <th>b</th>
      <th>1</th>
      <td>0.24</td>
      <td>0.04</td>
      <td>0.62</td>
      <td>0.76</td>
    </tr>
  </tbody>
</table>
</div>




```python
mdf.loc[:,('c2',1)]
```




    name1  name2
    a      1        0.05
           2        0.66
    b      1        0.62
           2        0.14
    c      1        0.13
           2        0.97
    Name: (c2, 1), dtype: float64




```python
idx_slice = pd.IndexSlice
mdf.loc[idx_slice[:,2], idx_slice[:,2]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>col_name1</th>
      <th>c1</th>
      <th>c2</th>
      <th>c3</th>
    </tr>
    <tr>
      <th></th>
      <th>col_name2</th>
      <th>2</th>
      <th>2</th>
      <th>2</th>
    </tr>
    <tr>
      <th>name1</th>
      <th>name2</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <th>2</th>
      <td>0.29</td>
      <td>0.17</td>
      <td>0.94</td>
    </tr>
    <tr>
      <th>b</th>
      <th>2</th>
      <td>0.92</td>
      <td>0.51</td>
      <td>0.32</td>
    </tr>
    <tr>
      <th>c</th>
      <th>2</th>
      <td>0.12</td>
      <td>0.38</td>
      <td>0.05</td>
    </tr>
  </tbody>
</table>
</div>



### 다중 인덱스 재정렬


```python
korea_mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남녀비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">서울특별시</th>
      <th>2010</th>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
      <td>98.269140</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">부산광역시</th>
      <th>2010</th>
      <td>2567910</td>
      <td>1773170</td>
      <td>1794740</td>
      <td>98.798155</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">인천광역시</th>
      <th>2010</th>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대구광역시</th>
      <th>2010</th>
      <td>2511676</td>
      <td>1255245</td>
      <td>1256431</td>
      <td>99.905606</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대전광역시</th>
      <th>2010</th>
      <td>1503664</td>
      <td>753648</td>
      <td>750016</td>
      <td>100.484256</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">광주광역시</th>
      <th>2010</th>
      <td>1454636</td>
      <td>721780</td>
      <td>732856</td>
      <td>98.488653</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1455048</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
  </tbody>
</table>
</div>




```python
# korea_mdf['서울특별시':'인천광역시']

korea_mdf = korea_mdf.sort_index()
korea_mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남녀비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">광주광역시</th>
      <th>2010</th>
      <td>1454636</td>
      <td>721780</td>
      <td>732856</td>
      <td>98.488653</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1455048</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대구광역시</th>
      <th>2010</th>
      <td>2511676</td>
      <td>1255245</td>
      <td>1256431</td>
      <td>99.905606</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대전광역시</th>
      <th>2010</th>
      <td>1503664</td>
      <td>753648</td>
      <td>750016</td>
      <td>100.484256</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">부산광역시</th>
      <th>2010</th>
      <td>2567910</td>
      <td>1773170</td>
      <td>1794740</td>
      <td>98.798155</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">서울특별시</th>
      <th>2010</th>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
      <td>98.269140</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">인천광역시</th>
      <th>2010</th>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_mdf['서울특별시':'인천광역시']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남녀비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">서울특별시</th>
      <th>2010</th>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
      <td>98.269140</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">인천광역시</th>
      <th>2010</th>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_mdf.unstack(level=0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="6" halign="left">총인구수</th>
      <th colspan="4" halign="left">남자인구수</th>
      <th>...</th>
      <th colspan="4" halign="left">여자인구수</th>
      <th colspan="6" halign="left">남녀비율</th>
    </tr>
    <tr>
      <th></th>
      <th>광주광역시</th>
      <th>대구광역시</th>
      <th>대전광역시</th>
      <th>부산광역시</th>
      <th>서울특별시</th>
      <th>인천광역시</th>
      <th>광주광역시</th>
      <th>대구광역시</th>
      <th>대전광역시</th>
      <th>부산광역시</th>
      <th>...</th>
      <th>대전광역시</th>
      <th>부산광역시</th>
      <th>서울특별시</th>
      <th>인천광역시</th>
      <th>광주광역시</th>
      <th>대구광역시</th>
      <th>대전광역시</th>
      <th>부산광역시</th>
      <th>서울특별시</th>
      <th>인천광역시</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010</th>
      <td>1454636</td>
      <td>2511676</td>
      <td>1503664</td>
      <td>2567910</td>
      <td>10312545</td>
      <td>2758296</td>
      <td>721780</td>
      <td>1255245</td>
      <td>753648</td>
      <td>1773170</td>
      <td>...</td>
      <td>750016</td>
      <td>1794740</td>
      <td>5201286</td>
      <td>1367940</td>
      <td>98.488653</td>
      <td>99.905606</td>
      <td>100.484256</td>
      <td>98.798155</td>
      <td>98.269140</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1455048</td>
      <td>2427954</td>
      <td>1471040</td>
      <td>3404423</td>
      <td>9720846</td>
      <td>2947217</td>
      <td>720060</td>
      <td>1198815</td>
      <td>734441</td>
      <td>1668618</td>
      <td>...</td>
      <td>736599</td>
      <td>1735805</td>
      <td>4988571</td>
      <td>1470404</td>
      <td>97.968946</td>
      <td>97.532907</td>
      <td>99.707032</td>
      <td>96.129346</td>
      <td>94.862336</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 24 columns</p>
</div>




```python
korea_mdf.unstack(level=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">총인구수</th>
      <th colspan="2" halign="left">남자인구수</th>
      <th colspan="2" halign="left">여자인구수</th>
      <th colspan="2" halign="left">남녀비율</th>
    </tr>
    <tr>
      <th></th>
      <th>2010</th>
      <th>2020</th>
      <th>2010</th>
      <th>2020</th>
      <th>2010</th>
      <th>2020</th>
      <th>2010</th>
      <th>2020</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>광주광역시</th>
      <td>1454636</td>
      <td>1455048</td>
      <td>721780</td>
      <td>720060</td>
      <td>732856</td>
      <td>734988</td>
      <td>98.488653</td>
      <td>97.968946</td>
    </tr>
    <tr>
      <th>대구광역시</th>
      <td>2511676</td>
      <td>2427954</td>
      <td>1255245</td>
      <td>1198815</td>
      <td>1256431</td>
      <td>1229139</td>
      <td>99.905606</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th>대전광역시</th>
      <td>1503664</td>
      <td>1471040</td>
      <td>753648</td>
      <td>734441</td>
      <td>750016</td>
      <td>736599</td>
      <td>100.484256</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th>부산광역시</th>
      <td>2567910</td>
      <td>3404423</td>
      <td>1773170</td>
      <td>1668618</td>
      <td>1794740</td>
      <td>1735805</td>
      <td>98.798155</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>서울특별시</th>
      <td>10312545</td>
      <td>9720846</td>
      <td>5111259</td>
      <td>4732275</td>
      <td>5201286</td>
      <td>4988571</td>
      <td>98.269140</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th>인천광역시</th>
      <td>2758296</td>
      <td>2947217</td>
      <td>1390356</td>
      <td>1476813</td>
      <td>1367940</td>
      <td>1470404</td>
      <td>101.638668</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
korea_mdf.stack()
```




    광주광역시  2010  총인구수     1.454636e+06
                 남자인구수    7.217800e+05
                 여자인구수    7.328560e+05
                 남녀비율     9.848865e+01
           2020  총인구수     1.455048e+06
                 남자인구수    7.200600e+05
                 여자인구수    7.349880e+05
                 남녀비율     9.796895e+01
    대구광역시  2010  총인구수     2.511676e+06
                 남자인구수    1.255245e+06
                 여자인구수    1.256431e+06
                 남녀비율     9.990561e+01
           2020  총인구수     2.427954e+06
                 남자인구수    1.198815e+06
                 여자인구수    1.229139e+06
                 남녀비율     9.753291e+01
    대전광역시  2010  총인구수     1.503664e+06
                 남자인구수    7.536480e+05
                 여자인구수    7.500160e+05
                 남녀비율     1.004843e+02
           2020  총인구수     1.471040e+06
                 남자인구수    7.344410e+05
                 여자인구수    7.365990e+05
                 남녀비율     9.970703e+01
    부산광역시  2010  총인구수     2.567910e+06
                 남자인구수    1.773170e+06
                 여자인구수    1.794740e+06
                 남녀비율     9.879815e+01
           2020  총인구수     3.404423e+06
                 남자인구수    1.668618e+06
                 여자인구수    1.735805e+06
                 남녀비율     9.612935e+01
    서울특별시  2010  총인구수     1.031254e+07
                 남자인구수    5.111259e+06
                 여자인구수    5.201286e+06
                 남녀비율     9.826914e+01
           2020  총인구수     9.720846e+06
                 남자인구수    4.732275e+06
                 여자인구수    4.988571e+06
                 남녀비율     9.486234e+01
    인천광역시  2010  총인구수     2.758296e+06
                 남자인구수    1.390356e+06
                 여자인구수    1.367940e+06
                 남녀비율     1.016387e+02
           2020  총인구수     2.947217e+06
                 남자인구수    1.476813e+06
                 여자인구수    1.470404e+06
                 남녀비율     1.004359e+02
    dtype: float64




```python
korea_mdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남녀비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">광주광역시</th>
      <th>2010</th>
      <td>1454636</td>
      <td>721780</td>
      <td>732856</td>
      <td>98.488653</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1455048</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대구광역시</th>
      <th>2010</th>
      <td>2511676</td>
      <td>1255245</td>
      <td>1256431</td>
      <td>99.905606</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">대전광역시</th>
      <th>2010</th>
      <td>1503664</td>
      <td>753648</td>
      <td>750016</td>
      <td>100.484256</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">부산광역시</th>
      <th>2010</th>
      <td>2567910</td>
      <td>1773170</td>
      <td>1794740</td>
      <td>98.798155</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">서울특별시</th>
      <th>2010</th>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
      <td>98.269140</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">인천광역시</th>
      <th>2010</th>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
idx_flat = korea_mdf.reset_index(level=0)
idx_flat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>level_0</th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남녀비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010</th>
      <td>광주광역시</td>
      <td>1454636</td>
      <td>721780</td>
      <td>732856</td>
      <td>98.488653</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>광주광역시</td>
      <td>1455048</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>대구광역시</td>
      <td>2511676</td>
      <td>1255245</td>
      <td>1256431</td>
      <td>99.905606</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>대구광역시</td>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>대전광역시</td>
      <td>1503664</td>
      <td>753648</td>
      <td>750016</td>
      <td>100.484256</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>대전광역시</td>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>부산광역시</td>
      <td>2567910</td>
      <td>1773170</td>
      <td>1794740</td>
      <td>98.798155</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>부산광역시</td>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>서울특별시</td>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
      <td>98.269140</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>서울특별시</td>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>인천광역시</td>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>2020</th>
      <td>인천광역시</td>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
idx_flat = korea_mdf.reset_index(level=(0,1))
idx_flat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>level_0</th>
      <th>level_1</th>
      <th>총인구수</th>
      <th>남자인구수</th>
      <th>여자인구수</th>
      <th>남녀비율</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>광주광역시</td>
      <td>2010</td>
      <td>1454636</td>
      <td>721780</td>
      <td>732856</td>
      <td>98.488653</td>
    </tr>
    <tr>
      <th>1</th>
      <td>광주광역시</td>
      <td>2020</td>
      <td>1455048</td>
      <td>720060</td>
      <td>734988</td>
      <td>97.968946</td>
    </tr>
    <tr>
      <th>2</th>
      <td>대구광역시</td>
      <td>2010</td>
      <td>2511676</td>
      <td>1255245</td>
      <td>1256431</td>
      <td>99.905606</td>
    </tr>
    <tr>
      <th>3</th>
      <td>대구광역시</td>
      <td>2020</td>
      <td>2427954</td>
      <td>1198815</td>
      <td>1229139</td>
      <td>97.532907</td>
    </tr>
    <tr>
      <th>4</th>
      <td>대전광역시</td>
      <td>2010</td>
      <td>1503664</td>
      <td>753648</td>
      <td>750016</td>
      <td>100.484256</td>
    </tr>
    <tr>
      <th>5</th>
      <td>대전광역시</td>
      <td>2020</td>
      <td>1471040</td>
      <td>734441</td>
      <td>736599</td>
      <td>99.707032</td>
    </tr>
    <tr>
      <th>6</th>
      <td>부산광역시</td>
      <td>2010</td>
      <td>2567910</td>
      <td>1773170</td>
      <td>1794740</td>
      <td>98.798155</td>
    </tr>
    <tr>
      <th>7</th>
      <td>부산광역시</td>
      <td>2020</td>
      <td>3404423</td>
      <td>1668618</td>
      <td>1735805</td>
      <td>96.129346</td>
    </tr>
    <tr>
      <th>8</th>
      <td>서울특별시</td>
      <td>2010</td>
      <td>10312545</td>
      <td>5111259</td>
      <td>5201286</td>
      <td>98.269140</td>
    </tr>
    <tr>
      <th>9</th>
      <td>서울특별시</td>
      <td>2020</td>
      <td>9720846</td>
      <td>4732275</td>
      <td>4988571</td>
      <td>94.862336</td>
    </tr>
    <tr>
      <th>10</th>
      <td>인천광역시</td>
      <td>2010</td>
      <td>2758296</td>
      <td>1390356</td>
      <td>1367940</td>
      <td>101.638668</td>
    </tr>
    <tr>
      <th>11</th>
      <td>인천광역시</td>
      <td>2020</td>
      <td>2947217</td>
      <td>1476813</td>
      <td>1470404</td>
      <td>100.435867</td>
    </tr>
  </tbody>
</table>
</div>




```python
idx_flat.set_index(['행정구역','년도'])
```


    ---------------------------------------------------------------------------

    KeyError                                  Traceback (most recent call last)

    <ipython-input-148-6c0cd83558c6> in <module>
    ----> 1 idx_flat.set_index(['행정구역','년도'])
    

    ~\anaconda3\lib\site-packages\pandas\core\frame.py in set_index(self, keys, drop, append, inplace, verify_integrity)
       4725 
       4726         if missing:
    -> 4727             raise KeyError(f"None of {missing} are in the columns")
       4728 
       4729         if inplace:
    

    KeyError: "None of ['행정구역', '년도'] are in the columns"


### 데이터 연산


```python
s = pd.Series(np.random.randint(0,10,5))
s
```




    0    1
    1    8
    2    6
    3    9
    4    8
    dtype: int32




```python
df = pd.DataFrame(np.random.randint(0,10,(3,3)),
                 columns=["A","B","C"])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
np.exp(s)
```




    0       2.718282
    1    2980.957987
    2     403.428793
    3    8103.083928
    4    2980.957987
    dtype: float64




```python
np.cos(df * np.pi / 4)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.000000</td>
      <td>-1.836970e-16</td>
      <td>-0.707107</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.707107</td>
      <td>-1.000000e+00</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.000000</td>
      <td>7.071068e-01</td>
      <td>0.707107</td>
    </tr>
  </tbody>
</table>
</div>




```python
s1 = pd.Series([1,3,5,7,9], index=[0, 1, 2, 3, 4])
s2 = pd.Series([2,4,6,8,10], index=[1,2,3,4,5])
s1 + s2
```




    0     NaN
    1     5.0
    2     9.0
    3    13.0
    4    17.0
    5     NaN
    dtype: float64




```python
s1.add(s2, fill_value=0)
```




    0     1.0
    1     5.0
    2     9.0
    3    13.0
    4    17.0
    5    10.0
    dtype: float64




```python
df1 = pd.DataFrame(np.random.randint(0,20,(3,3)),
                  columns=list('ACD'))
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9</td>
      <td>19</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18</td>
      <td>14</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2 = pd.DataFrame(np.random.randint(0,20,(5,5)),
                  columns=list('BAECD'))
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>A</th>
      <th>E</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>6</td>
      <td>0</td>
      <td>11</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>16</td>
      <td>6</td>
      <td>9</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>10</td>
      <td>4</td>
      <td>18</td>
      <td>16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12</td>
      <td>17</td>
      <td>16</td>
      <td>11</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>1</td>
      <td>5</td>
      <td>9</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 + df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.0</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34.0</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>15.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.0</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>17.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
fvalue = df1.stack().mean()
df1.add(df2,fill_value=fvalue)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>15.000000</td>
      <td>20.111111</td>
      <td>30.000000</td>
      <td>12.000000</td>
      <td>9.111111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>34.000000</td>
      <td>10.111111</td>
      <td>23.000000</td>
      <td>15.000000</td>
      <td>15.111111</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.000000</td>
      <td>17.111111</td>
      <td>23.000000</td>
      <td>17.000000</td>
      <td>13.111111</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26.111111</td>
      <td>21.111111</td>
      <td>20.111111</td>
      <td>17.111111</td>
      <td>25.111111</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.111111</td>
      <td>11.111111</td>
      <td>18.111111</td>
      <td>19.111111</td>
      <td>14.111111</td>
    </tr>
  </tbody>
</table>
</div>



### 연산자 범용 함수


```python
a = np.random.randint(1,10,size=(3,3))
a
```




    array([[4, 4, 5],
           [6, 9, 1],
           [1, 4, 8]])




```python
a + a[0]
```




    array([[ 8,  8, 10],
           [10, 13,  6],
           [ 5,  8, 13]])




```python
df = pd.DataFrame(a, columns=list('ABC'))
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df + df.iloc[0]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>8</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>8</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.add(df.iloc[0])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>8</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>13</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>8</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div>



### sub()/ subtract()


```python
a
```




    array([[4, 4, 5],
           [6, 9, 1],
           [1, 4, 8]])




```python
a - a[0]
```




    array([[ 0,  0,  0],
           [ 2,  5, -4],
           [-3,  0,  3]])




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df - df.iloc[0]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>-4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sub(df.iloc[0])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>5</td>
      <td>-4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.subtract(df['B'],axis=0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-3</td>
      <td>0</td>
      <td>-8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3</td>
      <td>0</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>



### mul()/multiply()


```python
a
```




    array([[4, 4, 5],
           [6, 9, 1],
           [1, 4, 8]])




```python
a * a[1]
```




    array([[24, 36,  5],
           [36, 81,  1],
           [ 6, 36,  8]])




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df * df.iloc[1]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24</td>
      <td>36</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36</td>
      <td>81</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>36</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.mul(df.iloc[1])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24</td>
      <td>36</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36</td>
      <td>81</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>36</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.multiply(df.iloc[2])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>16</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>36</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>16</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
</div>



### truediv()/div()/divide()/floordiv()


```python
a
```




    array([[4, 4, 5],
           [6, 9, 1],
           [1, 4, 8]])




```python
a / a[0]
```




    array([[1.  , 1.  , 1.  ],
           [1.5 , 2.25, 0.2 ],
           [0.25, 1.  , 1.6 ]])




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df / df.iloc[0]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.50</td>
      <td>2.25</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.25</td>
      <td>1.00</td>
      <td>1.6</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.truediv(df.iloc[0])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.50</td>
      <td>2.25</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.25</td>
      <td>1.00</td>
      <td>1.6</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.div(df.iloc[1])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.666667</td>
      <td>0.444444</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.166667</td>
      <td>0.444444</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.divide(df.iloc[2])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.0</td>
      <td>1.00</td>
      <td>0.625</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.0</td>
      <td>2.25</td>
      <td>0.125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>1.00</td>
      <td>1.000</td>
    </tr>
  </tbody>
</table>
</div>




```python
a // a[0]
```




    array([[1, 1, 1],
           [1, 2, 0],
           [0, 1, 1]], dtype=int32)




```python
df.floordiv(df.iloc[0])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



### mod()


```python
a
```




    array([[4, 4, 5],
           [6, 9, 1],
           [1, 4, 8]])




```python
a % a[0]
```




    array([[0, 0, 0],
           [2, 1, 1],
           [1, 0, 3]], dtype=int32)




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.mod(df.iloc[0])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



### pow()


```python
a
```




    array([[4, 4, 5],
           [6, 9, 1],
           [1, 4, 8]])




```python
a ** a[0]
```




    array([[  256,   256,  3125],
           [ 1296,  6561,     1],
           [    1,   256, 32768]], dtype=int32)




```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>4</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.pow(df.iloc[0])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>256</td>
      <td>256</td>
      <td>3125</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1296</td>
      <td>6561</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>256</td>
      <td>32768</td>
    </tr>
  </tbody>
</table>
</div>




```python
row = df.iloc[0, ::2]
row
```




    A    4
    C    5
    Name: 0, dtype: int32




```python
df - row
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>-4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3.0</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>



### 정렬(sort)


```python
s = pd.Series(range(5), index=['A',"D",'B',"C",'E'])
s
```




    A    0
    D    1
    B    2
    C    3
    E    4
    dtype: int64




```python
s.sort_index()
```




    A    0
    B    2
    C    3
    D    1
    E    4
    dtype: int64




```python
s.sort_values()
```




    A    0
    D    1
    B    2
    C    3
    E    4
    dtype: int64




```python
df = pd.DataFrame(np.random.randint(0,10,(4,4)),
                 index=[2,4,1,3],
                 columns = list('BDAC'))
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_index(axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>8</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>8</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>6</td>
      <td>6</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_values(by='A')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_values(by=['A','C'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>D</th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>2</td>
      <td>1</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



### 순위


```python
s = pd.Series([-2,4,7,3,0,7,5,-4,2,6])
s
```




    0   -2
    1    4
    2    7
    3    3
    4    0
    5    7
    6    5
    7   -4
    8    2
    9    6
    dtype: int64




```python
s.rank()
```




    0    2.0
    1    6.0
    2    9.5
    3    5.0
    4    3.0
    5    9.5
    6    7.0
    7    1.0
    8    4.0
    9    8.0
    dtype: float64




```python
s.rank(method='first')
```




    0     2.0
    1     6.0
    2     9.0
    3     5.0
    4     3.0
    5    10.0
    6     7.0
    7     1.0
    8     4.0
    9     8.0
    dtype: float64




```python
s.rank(method='max')
```




    0     2.0
    1     6.0
    2    10.0
    3     5.0
    4     3.0
    5    10.0
    6     7.0
    7     1.0
    8     4.0
    9     8.0
    dtype: float64



### 고성능 연산


```python
nrows, ncols = 100000, 100
df1, df2, df3, df4 = (pd.DataFrame(np.random.rand(nrows,ncols)) for i in range(4))
```


```python
%timeit df1 + df2 + df3 + df4
```

    43.1 ms ± 959 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
    


```python
%timeit pd.eval('df1 + df2 + df3 + df4')
```

    18.5 ms ± 222 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
    


```python
%timeit df1 * -df2 / (-df3 * df4)
```

    85.4 ms ± 432 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
    


```python
%timeit pd.eval('df1 * -df2 / (-df3 * df4)')
```

    21.3 ms ± 615 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
    


```python
%timeit (df1 < df2 ) & (df2 <= df3) & (df3 != df4)
```

    29.2 ms ± 369 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
    


```python
%timeit pd.eval('(df1 < df2 ) & (df2 <= df3) & (df3 != df4)')
```

    25.4 ms ± 717 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
    


```python
df = pd.DataFrame(np.random.rand(1000000,5), columns = ['A','B','C','D','E'])
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.308938</td>
      <td>0.760172</td>
      <td>0.004385</td>
      <td>0.692173</td>
      <td>0.484017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.391214</td>
      <td>0.084581</td>
      <td>0.356146</td>
      <td>0.188013</td>
      <td>0.598789</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.749444</td>
      <td>0.736076</td>
      <td>0.468447</td>
      <td>0.346982</td>
      <td>0.450787</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.218657</td>
      <td>0.363779</td>
      <td>0.497587</td>
      <td>0.462850</td>
      <td>0.396246</td>
    </tr>
  </tbody>
</table>
</div>




```python
%timeit df['A'] + df['B'] / df['C'] - df['D'] * df['E']
```

    10.6 ms ± 149 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
    


```python
%timeit pd.eval('df.A + df.B / df.C - df.D * df.E')
```

    4.68 ms ± 213 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
    


```python
%timeit df.eval('A + B / C - D * E')
```

    8.29 ms ± 90.1 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
    


```python
df.eval('R = A + B / C - D * E', inplace = True)
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.308938</td>
      <td>0.760172</td>
      <td>0.004385</td>
      <td>0.692173</td>
      <td>0.484017</td>
      <td>173.334758</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
      <td>-0.247921</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.391214</td>
      <td>0.084581</td>
      <td>0.356146</td>
      <td>0.188013</td>
      <td>0.598789</td>
      <td>0.516124</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.749444</td>
      <td>0.736076</td>
      <td>0.468447</td>
      <td>0.346982</td>
      <td>0.450787</td>
      <td>2.164341</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.218657</td>
      <td>0.363779</td>
      <td>0.497587</td>
      <td>0.462850</td>
      <td>0.396246</td>
      <td>0.766341</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.eval('R = A - B / C + D * E', inplace = True)
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.308938</td>
      <td>0.760172</td>
      <td>0.004385</td>
      <td>0.692173</td>
      <td>0.484017</td>
      <td>-172.716882</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
      <td>0.921947</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.391214</td>
      <td>0.084581</td>
      <td>0.356146</td>
      <td>0.188013</td>
      <td>0.598789</td>
      <td>0.266305</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.749444</td>
      <td>0.736076</td>
      <td>0.468447</td>
      <td>0.346982</td>
      <td>0.450787</td>
      <td>-0.665452</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.218657</td>
      <td>0.363779</td>
      <td>0.497587</td>
      <td>0.462850</td>
      <td>0.396246</td>
      <td>-0.329027</td>
    </tr>
  </tbody>
</table>
</div>




```python
col_mean = df.mean(1)
df['A'] + col_mean
```




    0        -28.102261
    1          0.982723
    2          0.705389
    3          1.097159
    4          0.487005
                ...    
    999995     0.377213
    999996     0.951678
    999997     0.324453
    999998     0.670394
    999999     0.577939
    Length: 1000000, dtype: float64




```python
df.eval('A + @col_mean')
```




    0        -28.102261
    1          0.982723
    2          0.705389
    3          1.097159
    4          0.487005
                ...    
    999995     0.377213
    999996     0.951678
    999997     0.324453
    999998     0.670394
    999999     0.577939
    Length: 1000000, dtype: float64




```python
df[((df.A < 0.5) & (df.B  < 0.5) & (df.C > 0.5))]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
      <td>0.921947</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.393496</td>
      <td>0.428890</td>
      <td>0.568641</td>
      <td>0.832768</td>
      <td>0.098808</td>
      <td>-0.278458</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.187391</td>
      <td>0.272626</td>
      <td>0.607700</td>
      <td>0.238132</td>
      <td>0.468022</td>
      <td>-0.149778</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.013381</td>
      <td>0.199618</td>
      <td>0.553482</td>
      <td>0.723326</td>
      <td>0.288805</td>
      <td>-0.138378</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.320100</td>
      <td>0.279848</td>
      <td>0.941695</td>
      <td>0.416427</td>
      <td>0.867114</td>
      <td>0.384014</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>999975</th>
      <td>0.290215</td>
      <td>0.147620</td>
      <td>0.522244</td>
      <td>0.475640</td>
      <td>0.109800</td>
      <td>0.059775</td>
    </tr>
    <tr>
      <th>999977</th>
      <td>0.180104</td>
      <td>0.187346</td>
      <td>0.808705</td>
      <td>0.199698</td>
      <td>0.708329</td>
      <td>0.089895</td>
    </tr>
    <tr>
      <th>999985</th>
      <td>0.021637</td>
      <td>0.200289</td>
      <td>0.817076</td>
      <td>0.377492</td>
      <td>0.486525</td>
      <td>-0.039832</td>
    </tr>
    <tr>
      <th>999992</th>
      <td>0.433221</td>
      <td>0.123979</td>
      <td>0.934485</td>
      <td>0.952054</td>
      <td>0.854816</td>
      <td>1.114382</td>
    </tr>
    <tr>
      <th>999997</th>
      <td>0.125301</td>
      <td>0.100793</td>
      <td>0.676276</td>
      <td>0.051815</td>
      <td>0.251436</td>
      <td>-0.010713</td>
    </tr>
  </tbody>
</table>
<p>124459 rows × 6 columns</p>
</div>




```python
pd.eval('df[((df.A < 0.5) & (df.B  < 0.5) & (df.C > 0.5))]')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
      <td>0.921947</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.393496</td>
      <td>0.428890</td>
      <td>0.568641</td>
      <td>0.832768</td>
      <td>0.098808</td>
      <td>-0.278458</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.187391</td>
      <td>0.272626</td>
      <td>0.607700</td>
      <td>0.238132</td>
      <td>0.468022</td>
      <td>-0.149778</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.013381</td>
      <td>0.199618</td>
      <td>0.553482</td>
      <td>0.723326</td>
      <td>0.288805</td>
      <td>-0.138378</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.320100</td>
      <td>0.279848</td>
      <td>0.941695</td>
      <td>0.416427</td>
      <td>0.867114</td>
      <td>0.384014</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>999975</th>
      <td>0.290215</td>
      <td>0.147620</td>
      <td>0.522244</td>
      <td>0.475640</td>
      <td>0.109800</td>
      <td>0.059775</td>
    </tr>
    <tr>
      <th>999977</th>
      <td>0.180104</td>
      <td>0.187346</td>
      <td>0.808705</td>
      <td>0.199698</td>
      <td>0.708329</td>
      <td>0.089895</td>
    </tr>
    <tr>
      <th>999985</th>
      <td>0.021637</td>
      <td>0.200289</td>
      <td>0.817076</td>
      <td>0.377492</td>
      <td>0.486525</td>
      <td>-0.039832</td>
    </tr>
    <tr>
      <th>999992</th>
      <td>0.433221</td>
      <td>0.123979</td>
      <td>0.934485</td>
      <td>0.952054</td>
      <td>0.854816</td>
      <td>1.114382</td>
    </tr>
    <tr>
      <th>999997</th>
      <td>0.125301</td>
      <td>0.100793</td>
      <td>0.676276</td>
      <td>0.051815</td>
      <td>0.251436</td>
      <td>-0.010713</td>
    </tr>
  </tbody>
</table>
<p>124459 rows × 6 columns</p>
</div>




```python
df.query('(A < 0.5) and (B < 0.5) and (C > 0.5)')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
      <td>0.921947</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.393496</td>
      <td>0.428890</td>
      <td>0.568641</td>
      <td>0.832768</td>
      <td>0.098808</td>
      <td>-0.278458</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.187391</td>
      <td>0.272626</td>
      <td>0.607700</td>
      <td>0.238132</td>
      <td>0.468022</td>
      <td>-0.149778</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.013381</td>
      <td>0.199618</td>
      <td>0.553482</td>
      <td>0.723326</td>
      <td>0.288805</td>
      <td>-0.138378</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.320100</td>
      <td>0.279848</td>
      <td>0.941695</td>
      <td>0.416427</td>
      <td>0.867114</td>
      <td>0.384014</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>999975</th>
      <td>0.290215</td>
      <td>0.147620</td>
      <td>0.522244</td>
      <td>0.475640</td>
      <td>0.109800</td>
      <td>0.059775</td>
    </tr>
    <tr>
      <th>999977</th>
      <td>0.180104</td>
      <td>0.187346</td>
      <td>0.808705</td>
      <td>0.199698</td>
      <td>0.708329</td>
      <td>0.089895</td>
    </tr>
    <tr>
      <th>999985</th>
      <td>0.021637</td>
      <td>0.200289</td>
      <td>0.817076</td>
      <td>0.377492</td>
      <td>0.486525</td>
      <td>-0.039832</td>
    </tr>
    <tr>
      <th>999992</th>
      <td>0.433221</td>
      <td>0.123979</td>
      <td>0.934485</td>
      <td>0.952054</td>
      <td>0.854816</td>
      <td>1.114382</td>
    </tr>
    <tr>
      <th>999997</th>
      <td>0.125301</td>
      <td>0.100793</td>
      <td>0.676276</td>
      <td>0.051815</td>
      <td>0.251436</td>
      <td>-0.010713</td>
    </tr>
  </tbody>
</table>
<p>124459 rows × 6 columns</p>
</div>




```python
col_mean = df['D'].mean()
df[(df.A < col_mean) & (df.B < col_mean)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
      <td>0.921947</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.391214</td>
      <td>0.084581</td>
      <td>0.356146</td>
      <td>0.188013</td>
      <td>0.598789</td>
      <td>0.266305</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.218657</td>
      <td>0.363779</td>
      <td>0.497587</td>
      <td>0.462850</td>
      <td>0.396246</td>
      <td>-0.329027</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.393496</td>
      <td>0.428890</td>
      <td>0.568641</td>
      <td>0.832768</td>
      <td>0.098808</td>
      <td>-0.278458</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.257137</td>
      <td>0.004603</td>
      <td>0.409605</td>
      <td>0.224643</td>
      <td>0.286858</td>
      <td>0.310341</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>999992</th>
      <td>0.433221</td>
      <td>0.123979</td>
      <td>0.934485</td>
      <td>0.952054</td>
      <td>0.854816</td>
      <td>1.114382</td>
    </tr>
    <tr>
      <th>999994</th>
      <td>0.373606</td>
      <td>0.131317</td>
      <td>0.039340</td>
      <td>0.362022</td>
      <td>0.034592</td>
      <td>-2.951837</td>
    </tr>
    <tr>
      <th>999997</th>
      <td>0.125301</td>
      <td>0.100793</td>
      <td>0.676276</td>
      <td>0.051815</td>
      <td>0.251436</td>
      <td>-0.010713</td>
    </tr>
    <tr>
      <th>999998</th>
      <td>0.373241</td>
      <td>0.013203</td>
      <td>0.398271</td>
      <td>0.202588</td>
      <td>0.378784</td>
      <td>0.416827</td>
    </tr>
    <tr>
      <th>999999</th>
      <td>0.092165</td>
      <td>0.056693</td>
      <td>0.471699</td>
      <td>0.880529</td>
      <td>0.766582</td>
      <td>0.646974</td>
    </tr>
  </tbody>
</table>
<p>250368 rows × 6 columns</p>
</div>




```python
df.query('A < @col_mean and B < @col_mean')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.337013</td>
      <td>0.111955</td>
      <td>0.800246</td>
      <td>0.834123</td>
      <td>0.868978</td>
      <td>0.921947</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.391214</td>
      <td>0.084581</td>
      <td>0.356146</td>
      <td>0.188013</td>
      <td>0.598789</td>
      <td>0.266305</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.218657</td>
      <td>0.363779</td>
      <td>0.497587</td>
      <td>0.462850</td>
      <td>0.396246</td>
      <td>-0.329027</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.393496</td>
      <td>0.428890</td>
      <td>0.568641</td>
      <td>0.832768</td>
      <td>0.098808</td>
      <td>-0.278458</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.257137</td>
      <td>0.004603</td>
      <td>0.409605</td>
      <td>0.224643</td>
      <td>0.286858</td>
      <td>0.310341</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>999992</th>
      <td>0.433221</td>
      <td>0.123979</td>
      <td>0.934485</td>
      <td>0.952054</td>
      <td>0.854816</td>
      <td>1.114382</td>
    </tr>
    <tr>
      <th>999994</th>
      <td>0.373606</td>
      <td>0.131317</td>
      <td>0.039340</td>
      <td>0.362022</td>
      <td>0.034592</td>
      <td>-2.951837</td>
    </tr>
    <tr>
      <th>999997</th>
      <td>0.125301</td>
      <td>0.100793</td>
      <td>0.676276</td>
      <td>0.051815</td>
      <td>0.251436</td>
      <td>-0.010713</td>
    </tr>
    <tr>
      <th>999998</th>
      <td>0.373241</td>
      <td>0.013203</td>
      <td>0.398271</td>
      <td>0.202588</td>
      <td>0.378784</td>
      <td>0.416827</td>
    </tr>
    <tr>
      <th>999999</th>
      <td>0.092165</td>
      <td>0.056693</td>
      <td>0.471699</td>
      <td>0.880529</td>
      <td>0.766582</td>
      <td>0.646974</td>
    </tr>
  </tbody>
</table>
<p>250368 rows × 6 columns</p>
</div>



### 데이터 결합
    - Concat() / Append()


```python
s1 = pd.Series(['a', 'b'], index = [1,2])
s2 = pd.Series(['c', 'd'], index = [3,4])
pd.concat([s1, s2])
```




    1    a
    2    b
    3    c
    4    d
    dtype: object




```python
def create_df(cols, idx):
    data = {c: [str(c.lower()) + str(i) for i in idx] for c in cols}
    return pd.DataFrame(data, idx)
```


```python
df1 = create_df('AB', [1,2])
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2 = create_df('AB', [3,4])
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a4</td>
      <td>b4</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.concat([df1,df2])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a3</td>
      <td>b3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a4</td>
      <td>b4</td>
    </tr>
  </tbody>
</table>
</div>




```python
df3 = create_df('AB',[0,1])
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
    </tr>
  </tbody>
</table>
</div>




```python
df4 = create_df('CD', [0,1])
df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>c0</td>
      <td>d0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>c1</td>
      <td>d1</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.concat([df3,df4])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>c0</td>
      <td>d0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>c1</td>
      <td>d1</td>
    </tr>
  </tbody>
</table>
</div>




```python
# pd.concat([df1, df3], verify_intergrity = True)
```


```python
pd.concat([df1, df3], ignore_index = True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a1</td>
      <td>b1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a2</td>
      <td>b2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a0</td>
      <td>b0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a1</td>
      <td>b1</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.concat([df1, df3], keys = ['X','Y'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">X</th>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Y</th>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
    </tr>
  </tbody>
</table>
</div>




```python
df5 = create_df('ABC', [1,2])
df6 = create_df('BCD', [3,4])
pd.concat([df5,df6])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>b4</td>
      <td>c4</td>
      <td>d4</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.concat([df5, df6], join = 'inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>b1</td>
      <td>c1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b2</td>
      <td>c2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b3</td>
      <td>c3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>b4</td>
      <td>c4</td>
    </tr>
  </tbody>
</table>
</div>




```python
df5.append(df6)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a2</td>
      <td>b2</td>
      <td>c2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>b3</td>
      <td>c3</td>
      <td>d3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>b4</td>
      <td>c4</td>
      <td>d4</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.concat([df3, df4], axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a0</td>
      <td>b0</td>
      <td>c0</td>
      <td>d0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a1</td>
      <td>b1</td>
      <td>c1</td>
      <td>d1</td>
    </tr>
  </tbody>
</table>
</div>




```python

```
